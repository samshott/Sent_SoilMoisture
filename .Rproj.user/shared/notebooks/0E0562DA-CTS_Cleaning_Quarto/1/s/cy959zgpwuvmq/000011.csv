"0",""
"0","#create a new column for the Hexigon's ID"
"0",""
"0","den_Locations <- cts_table_Complete %>% "
"0","  mutate(h3_ind ="
"0","           geo_to_h3(c(as.numeric(Y_GPS), as.numeric(X_GPS)), res = 12))"
"0",""
"0","#change the column names for better viewing in popups"
"0","colnames(den_Locations)[c(4:7,29,32:35)] <- c(""Number of Entrances"","
"0","                                              ""Largest Entrance Diameter (in)"","
"0","                                              ""Depth at Deepest Point (ft)"","
"0","                                              ""Total Lenght (ft)"","
"0","                                              ""Species Found"","
"0","                                              ""Species Group"","
"0","                                              ""Den Volume (cubic in)"","
"0","                                              ""Den Volume (cubic ft)"","
"0","                                              ""H3 Index"")"
"0",""
"0","#keep only necessary columns, dplyr::select() could also be used for this"
"0","den_Locations_Small <- den_Locations[c(4:7,29,32:35)] %>%"
"0","  mutate(`Species Found` ="
"0","           ifelse(`Species Found` == ""Krat"" "
"0","                  | `Species Found` == ""Heermann's Kangaroo Rat"","
"0","                  ""Kangaroo Rat"","
"0","                  `Species Found`),"
"0","         `Number of Entrances` = as.numeric(`Number of Entrances`))#change number of entrances to numeric for future calculations"
"0",""
"0","den_Locations_H3 <- den_Locations_Small %>% "
"0","  group_by(`H3 Index`) %>% #group all information by the hexagonal indices for summarization"
"0","  summarise( #summarise each statistic within its hexagon"
"0","    `Total Occurances` = n(),"
"0","    `No Species Count` = sum(`Species Group` == ""None""),"
"0","    `Arachnid Count` =  sum(`Species Group` == ""Arachnids""),"
"0","    `Herptile (excl. CTS) Count` =  sum(`Species Group` == ""Herptiles (excl. CTS)""),"
"0","    `Kangaroo Rat Count` =  sum(`Species Group` == ""Kangaroo Rat""),"
"0","    `Rodent Count` = sum(`Species Group` == ""Rodents""),"
"0","    `Average Diameter (in)` = round(mean(`Largest Entrance Diameter (in)`), 2),"
"0","    `Average Depth (ft)` = round(mean(`Depth at Deepest Point (ft)`), 2),"
"0","    `Average Number of Entrances` = round(mean(`Number of Entrances`, na.rm = TRUE), 2),"
"0","    `Average Den Volume (cubic in)` = round(mean(`Den Volume (cubic in)`), 2),"
"0","    `Average Length (ft)` = round(mean(`Total Lenght (ft)`), 2),"
"0","    `Unique Species Found` = paste(unique(`Species Found`), collapse = "", "")"
"0","    )"
"0",""
"0","#Now a column just for the geometry is created"
"0",""
"0","den_Loc_H3_sf <- h3_to_geo_boundary_sf(den_Locations_H3$`H3 Index`) %>% "
"0","  cbind(den_Locations_H3[2:13])"
"0",""
"0",""
"0","center_coord <- c(mean(st_coordinates(den_Loc_H3_sf)[,1]),"
"0","                  mean(st_coordinates(den_Loc_H3_sf)[,2]))"
"0",""
"0","pal <- RColorBrewer::brewer.pal(11, ""YlOrRd"")"
"0",""
"0","names(den_Loc_H3_sf) <- c(colnames(den_Locations_H3)[2:13], ""geometry"")"
"0",""
"0","webmapH3 <- mapview(den_Loc_H3_sf,"
"0","                    map.type = ""Esri.WorldImagery"","
"0","                    zcol = ""Total Occurances"","
"0","                    layer.name = ""Total Occurances"","
"0","                    col.regions = pal, "
"0","                    alpha.regions = 0.7) "
"0","webmapH3@map %<>% "
"0","  setView(lng = center_coord[1],"
"0","          lat = center_coord[2],"
"0","          zoom = 16)"
"0","webmapH3"
